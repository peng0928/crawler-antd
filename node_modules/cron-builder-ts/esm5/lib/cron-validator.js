import { __read } from "tslib";
import { MEASURE_OF_TIME_MAP } from './types';
import { keys } from './utils';
var CronValidator = /** @class */ (function () {
    function CronValidator() {
    }
    /**
     * validates a given cron expression (object) for length, then calls validateValue on each value
     * @param {!{
     *  minute: Array.string,
     *  hour: Array.string,
     *  dayOfTheMonth: Array.string,
     *  month: Array.string,
     *  dayOfTheWeek: Array.string,
     * }} expression - rich object containing the state of the cron expression
     * @throws {Error} if expression contains more than 5 keys
     */
    CronValidator.validateExpression = function (expression) {
        // don't care if it's less than 5, we'll just set those to the default '*'
        if (keys(expression).length > MEASURE_OF_TIME_MAP.length) {
            throw new Error("Invalid cron expression; limited to " + MEASURE_OF_TIME_MAP.length + " values.");
        }
        keys(expression).forEach(function (key) {
            expression[key].forEach(function (value) {
                CronValidator.validateValue(key, value);
            });
        });
    };
    /**
     * validates a given cron expression (string) for length, then calls validateValue on each value
     * @param {!String} expression - an optionally empty string containing at most 5 space delimited expressions.
     * @throws {Error} if the string contains more than 5 space delimited parts.
     */
    CronValidator.validateString = function (expression) {
        var splitExpression = expression.split(' ');
        if (splitExpression.length > MEASURE_OF_TIME_MAP.length) {
            throw new Error("Invalid cron expression; limited to " + MEASURE_OF_TIME_MAP.length + " values.");
        }
        for (var i = 0; i < splitExpression.length; i += 1) {
            CronValidator.validateValue(MEASURE_OF_TIME_MAP[i], splitExpression[i]);
        }
    };
    /**
     * validates any given measureOfTime and corresponding value
     * @param {!String} measureOfTime - as expected
     * @param {!String} value - the cron-ish interval specifier
     * @throws {Error} if measureOfTime is bogus
     * @throws {Error} if value contains an unsupported character
     */
    CronValidator.validateValue = function (measureOfTime, value) {
        var validatorObj = {
            minute: { min: 0, max: 59 },
            hour: { min: 0, max: 23 },
            dayOfTheMonth: { min: 1, max: 31 },
            month: { min: 1, max: 12 },
            dayOfTheWeek: { min: 0, max: 7 }
        };
        var validChars = /^[0-9*-]/;
        if (!validatorObj[measureOfTime]) {
            throw new Error("Invalid measureOfTime; Valid options are: " + MEASURE_OF_TIME_MAP.join(', '));
        }
        if (!validChars.test(value)) {
            throw new Error('Invalid value; Only numbers 0-9, "-", and "*" chars are allowed');
        }
        if (value === '*') {
            return;
        }
        // check to see if value is within range if value is not '*'
        if (value.indexOf('-') >= 0) {
            // value is a range and must be split into high and low
            var rangeArray = value
                .split('-')
                .map(function (range) { return parseInt(range, 10); })
                .filter(function (range) { return isNaN(range) === false; });
            var _a = __read(rangeArray, 2), rangeMin = _a[0], rangeMax = _a[1];
            if (typeof rangeMin !== "number" || rangeMin < validatorObj[measureOfTime].min) {
                throw new Error("Invalid value; bottom of range is not valid for \\\"" + measureOfTime + "\\\". Limit is " + validatorObj[measureOfTime].min + ".");
            }
            if (typeof rangeMax !== "number" || rangeMax > validatorObj[measureOfTime].max) {
                throw new Error("Invalid value; top of range is not valid for \\\"" + measureOfTime + "\\\". Limit is " + validatorObj[measureOfTime].max + ".");
            }
        }
        else {
            if (parseInt(value) < validatorObj[measureOfTime].min) {
                throw new Error("Invalid value; given value is not valid for \\\"" + measureOfTime + "\\\". Minimum value is \\\"" + validatorObj[measureOfTime].min + "\\\".");
            }
            if (parseInt(value) > validatorObj[measureOfTime].max) {
                throw new Error("Invalid value; given value is not valid for \\\"" + measureOfTime + "\\\". Maximum value is \\\"" + validatorObj[measureOfTime].max + "\\\".");
            }
        }
    };
    return CronValidator;
}());
export { CronValidator };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3Jvbi12YWxpZGF0b3IuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9jcm9uLWJ1aWxkZXItdHMvIiwic291cmNlcyI6WyJsaWIvY3Jvbi12YWxpZGF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBYyxtQkFBbUIsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUMxRCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBRS9CO0lBQUE7SUFtR0EsQ0FBQztJQWxHQzs7Ozs7Ozs7OztPQVVHO0lBQ1csZ0NBQWtCLEdBQWhDLFVBQWlDLFVBQXNCO1FBQ3JELDBFQUEwRTtRQUMxRSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxNQUFNLEdBQUcsbUJBQW1CLENBQUMsTUFBTSxFQUFFO1lBQ3hELE1BQU0sSUFBSSxLQUFLLENBQUMseUNBQXVDLG1CQUFtQixDQUFDLE1BQU0sYUFBVSxDQUFDLENBQUM7U0FDOUY7UUFFRCxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsR0FBRztZQUMzQixVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBSztnQkFDNUIsYUFBYSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ1csNEJBQWMsR0FBNUIsVUFBNkIsVUFBa0I7UUFDN0MsSUFBTSxlQUFlLEdBQUcsVUFBVSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUU5QyxJQUFJLGVBQWUsQ0FBQyxNQUFNLEdBQUcsbUJBQW1CLENBQUMsTUFBTSxFQUFFO1lBQ3ZELE1BQU0sSUFBSSxLQUFLLENBQUMseUNBQXVDLG1CQUFtQixDQUFDLE1BQU0sYUFBVSxDQUFDLENBQUM7U0FDOUY7UUFFRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMs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QUNyRCxNQUFNLElBQUksS0FBSyxDQUFDLHFEQUFrRCxhQUFhLG1DQUE0QixZQUFZLENBQUMsYUFBYSxDQUFDLENBQUMsR0FBRyxVQUFNLENBQUMsQ0FBQzthQUNuSjtTQUNGO0lBQ0gsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQW5HRCxJQW1HQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV4cHJlc3Npb24sIE1FQVNVUkVfT0ZfVElNRV9NQVAgfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsga2V5cyB9IGZyb20gJy4vdXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIENyb25WYWxpZGF0b3Ige1xyXG4gIC8qKlxyXG4gICAqIHZhbGlkYXRlcyBhIGdpdmVuIGNyb24gZXhwcmVzc2lvbiAob2JqZWN0KSBmb3IgbGVuZ3RoLCB0aGVuIGNhbGxzIHZhbGlkYXRlVmFsdWUgb24gZWFjaCB2YWx1ZVxyXG4gICAqIEBwYXJhbSB7IXtcclxuICAgKiAgbWludXRlOiBBcnJheS5zdHJpbmcsXHJcbiAgICogIGhvdXI6IEFycmF5LnN0cmluZyxcclxuICAgKiAgZGF5T2ZUaGVNb250aDogQXJyYXkuc3RyaW5nLFxyXG4gICAqICBtb250aDogQXJyYXkuc3RyaW5nLFxyXG4gICAqICBkYXlPZlRoZVdlZWs6IEFycmF5LnN0cmluZyxcclxuICAgKiB9fSBleHByZXNzaW9uIC0gcmljaCBvYmplY3QgY29udGFpbmluZyB0aGUgc3RhdGUgb2YgdGhlIGNyb24gZXhwcmVzc2lvblxyXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBpZiBleHByZXNzaW9uIGNvbnRhaW5zIG1vcmUgdGhhbiA1IGtleXNcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHZhbGlkYXRlRXhwcmVzc2lvbihleHByZXNzaW9uOiBFeHByZXNzaW9uKTogdm9pZCB7XHJcbiAgICAvLyBkb24ndCBjYXJlIGlmIGl0J3MgbGVzcyB0aGFuIDUsIHdlJ2xsIGp1c3Qgc2V0IHRob3NlIHRvIHRoZSBkZWZhdWx0ICcqJ1xyXG4gICAgaWYgKGtleXMoZXhwcmVzc2lvbikubGVuZ3RoID4gTUVBU1VSRV9PRl9USU1FX01BUC5sZW5ndGgpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGNyb24gZXhwcmVzc2lvbjsgbGltaXRlZCB0byAke01FQVNVUkVfT0ZfVElNRV9NQVAubGVuZ3RofSB2YWx1ZXMuYCk7XHJcbiAgICB9XHJcblxyXG4gICAga2V5cyhleHByZXNzaW9uKS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgZXhwcmVzc2lvbltrZXldLmZvckVhY2goKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgQ3JvblZhbGlkYXRvci52YWxpZGF0ZVZhbHVlKGtleSwgdmFsdWUpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGVzIGEgZ2l2ZW4gY3JvbiBleHByZXNzaW9uIChzdHJpbmcpIGZvciBsZW5ndGgsIHRoZW4gY2FsbHMgdmFsaWRhdGVWYWx1ZSBvbiBlYWNoIHZhbHVlXHJcbiAgICogQHBhcmFtIHshU3RyaW5nfSBleHByZXNzaW9uIC0gYW4gb3B0aW9uYWxseSBlbXB0eSBzdHJpbmcgY29udGFpbmluZyBhdCBtb3N0IDUgc3BhY2UgZGVsaW1pdGVkIGV4cHJlc3Npb25zLlxyXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgc3RyaW5nIGNvbnRhaW5zIG1vcmUgdGhhbiA1IHNwYWNlIGRlbGltaXRlZCBwYXJ0cy5cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIHZhbGlkYXRlU3RyaW5nKGV4cHJlc3Npb246IHN0cmluZyk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3BsaXRFeHByZXNzaW9uID0gZXhwcmVzc2lvbi5zcGxpdCgnICcpO1xyXG5cclxuICAgIGlmIChzcGxpdEV4cHJlc3Npb24ubGVuZ3RoID4gTUVBU1VSRV9PRl9USU1FX01BUC5sZW5ndGgpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGNyb24gZXhwcmVzc2lvbjsgbGltaXRlZCB0byAke01FQVNVUkVfT0ZfVElNRV9NQVAubGVuZ3RofSB2YWx1ZXMuYCk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcGxpdEV4cHJlc3Npb24ubGVuZ3RoOyBpICs9IDEpIHtcclxuICAgICAgQ3JvblZhbGlkYXRvci52YWxpZGF0ZVZhbHVlKE1FQVNVUkVfT0ZfVElNRV9NQVBbaV0sIHNwbGl0RXhwcmVzc2lvbltpXSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiB2YWxpZGF0ZXMgYW55IGdpdmVuIG1lYXN1cmVPZlRpbWUgYW5kIGNvcnJlc3BvbmRpbmcgdmFsdWVcclxuICAgKiBAcGFyYW0geyFTdHJpbmd9IG1lYXN1cmVPZlRpbWUgLSBhcyBleHBlY3RlZFxyXG4gICAqIEBwYXJhbSB7IVN0cmluZ30gdmFsdWUgLSB0aGUgY3Jvbi1pc2ggaW50ZXJ2YWwgc3BlY2lmaWVyXHJcbiAgICogQHRocm93cyB7RXJyb3J9IGlmIG1lYXN1cmVPZlRpbWUgaXMgYm9ndXNcclxuICAgKiBAdGhyb3dzIHtFcnJvcn0gaWYgdmFsdWUgY29udGFpbnMgYW4gdW5zdXBwb3J0ZWQgY2hhcmFjdGVyXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyB2YWxpZGF0ZVZhbHVlKG1lYXN1cmVPZlRpbWU6IGtleW9mIEV4cHJlc3Npb24sIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNvbnN0IHZhbGlkYXRvck9iaiA9IHtcclxuICAgICAgbWludXRlOiB7IG1pbjogMCwgbWF4OiA1OSB9LFxyXG4gICAgICBob3VyOiB7IG1pbjogMCwgbWF4OiAyMyB9LFxyXG4gICAgICBkYXlPZlRoZU1vbnRoOiB7IG1pbjogMSwgbWF4OiAzMSB9LFxyXG4gICAgICBtb250aDogeyBtaW46IDEsIG1heDogMTIgfSxcclxuICAgICAgZGF5T2ZUaGVXZWVrOiB7IG1pbjogMCwgbWF4OiA3IH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgdmFsaWRDaGFycyA9IC9eWzAtOSotXS87XHJcblxyXG4gICAgaWYgKCF2YWxpZGF0b3JPYmpbbWVhc3VyZU9mVGltZV0pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG1lYXN1cmVPZlRpbWU7IFZhbGlkIG9wdGlvbnMgYXJlOiAke01FQVNVUkVfT0ZfVElNRV9NQVAuam9pbignLCAnKX1gKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXZhbGlkQ2hhcnMudGVzdCh2YWx1ZSkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHZhbHVlOyBPbmx5IG51bWJlcnMgMC05LCBcIi1cIiwgYW5kIFwiKlwiIGNoYXJzIGFyZSBhbGxvd2VkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZhbHVlID09PSAnKicpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNoZWNrIHRvIHNlZSBpZiB2YWx1ZSBpcyB3aXRoaW4gcmFuZ2UgaWYgdmFsdWUgaXMgbm90ICcqJ1xyXG4gICAgaWYgKHZhbHVlLmluZGV4T2YoJy0nKSA+PSAwKSB7XHJcbiAgICAgIC8vIHZhbHVlIGlzIGEgcmFuZ2UgYW5kIG11c3QgYmUgc3BsaXQgaW50byBoaWdoIGFuZCBsb3dcclxuICAgICAgY29uc3QgcmFuZ2VBcnJheTogUmVhZG9ubHlBcnJheTxudW1iZXIgfCB1bmRlZmluZWQ+ID0gdmFsdWVcclxuICAgICAgICAuc3BsaXQoJy0nKVxyXG4gICAgICAgIC5tYXAoKHJhbmdlKSA9PiBwYXJzZUludChyYW5nZSwgMTApKVxyXG4gICAgICAgIC5maWx0ZXIoKHJhbmdlKSA9PiBpc05hTihyYW5nZSkgPT09IGZhbHNlKTtcclxuXHJcbiAgICAgIGNvbnN0IFtyYW5nZU1pbiwgcmFuZ2VNYXhdID0gcmFuZ2VBcnJheTtcclxuXHJcbiAgICAgIGlmICh0eXBlb2YgcmFuZ2VNaW4gIT09IFwibnVtYmVyXCIgfHwgcmFuZ2VNaW4gPCB2YWxpZGF0b3JPYmpbbWVhc3VyZU9mVGltZV0ubWluKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZhbHVlOyBib3R0b20gb2YgcmFuZ2UgaXMgbm90IHZhbGlkIGZvciBcXFxcXCIke21lYXN1cmVPZlRpbWV9XFxcXFwiLiBMaW1pdCBpcyAke3ZhbGlkYXRvck9ialttZWFzdXJlT2ZUaW1lXS5taW59LmApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodHlwZW9mIHJhbmdlTWF4ICE9PSBcIm51bWJlclwiIHx8IHJhbmdlTWF4ID4gdmFsaWRhdG9yT2JqW21lYXN1cmVPZlRpbWVdLm1heCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB2YWx1ZTsgdG9wIG9mIHJhbmdlIGlzIG5vdCB2YWxpZCBmb3IgXFxcXFwiJHttZWFzdXJlT2ZUaW1lfVxcXFxcIi4gTGltaXQgaXMgJHt2YWxpZGF0b3JPYmpbbWVhc3VyZU9mVGltZV0ubWF4fS5gKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHBhcnNlSW50KHZhbHVlKSA8IHZhbGlkYXRvck9ialttZWFzdXJlT2ZUaW1lXS5taW4pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgdmFsdWU7IGdpdmVuIHZhbHVlIGlzIG5vdCB2YWxpZCBmb3IgXFxcXFwiJHttZWFzdXJlT2ZUaW1lfVxcXFxcIi4gTWluaW11bSB2YWx1ZSBpcyBcXFxcXCIke3ZhbGlkYXRvck9ialttZWFzdXJlT2ZUaW1lXS5taW59XFxcXFwiLmApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAocGFyc2VJbnQodmFsdWUpID4gdmFsaWRhdG9yT2JqW21lYXN1cmVPZlRpbWVdLm1heCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB2YWx1ZTsgZ2l2ZW4gdmFsdWUgaXMgbm90IHZhbGlkIGZvciBcXFxcXCIke21lYXN1cmVPZlRpbWV9XFxcXFwiLiBNYXhpbXVtIHZhbHVlIGlzIFxcXFxcIiR7dmFsaWRhdG9yT2JqW21lYXN1cmVPZlRpbWVdLm1heH1cXFxcXCIuYCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19